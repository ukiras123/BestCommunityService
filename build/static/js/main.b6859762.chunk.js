(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{15:function(e){e.exports={apiUrl:"http://localhost:4000"}},32:function(e,t,a){e.exports=a(42)},42:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),s=a(25),o=a(9),i=a(14),c=a(29),l=a(30),A={SUCCESS:"ALERT_SUCCESS",ERROR:"ALERT_ERROR",CLEAR:"ALERT_CLEAR"},u={REGISTER_REQUEST:"USERS_REGISTER_REQUEST",REGISTER_SUCCESS:"USERS_REGISTER_SUCCESS",REGISTER_FAILURE:"USERS_REGISTER_FAILURE",LOGIN_REQUEST:"USERS_LOGIN_REQUEST",LOGIN_SUCCESS:"USERS_LOGIN_SUCCESS",LOGIN_FAILURE:"USERS_LOGIN_FAILURE",LOGOUT:"USERS_LOGOUT",GETALL_REQUEST:"USERS_GETALL_REQUEST",GETALL_SUCCESS:"USERS_GETALL_SUCCESS",GETALL_FAILURE:"USERS_GETALL_FAILURE",DELETE_REQUEST:"USERS_DELETE_REQUEST",DELETE_SUCCESS:"USERS_DELETE_SUCCESS",DELETE_FAILURE:"USERS_DELETE_FAILURE"},m=JSON.parse(localStorage.getItem("user")),E=m?{loggedIn:!0,user:m}:{};var h=a(21),d=a(12);var g=Object(i.c)({authentication:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case u.LOGIN_REQUEST:return{loggingIn:!0,user:t.user};case u.LOGIN_SUCCESS:return{loggedIn:!0,user:t.user};case u.LOGIN_FAILURE:case u.LOGOUT:return{};default:return e}},registration:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};switch((arguments.length>1?arguments[1]:void 0).type){case u.REGISTER_REQUEST:return{registering:!0};case u.REGISTER_SUCCESS:case u.REGISTER_FAILURE:return{};default:return e}},users:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case u.GETALL_REQUEST:return{loading:!0};case u.GETALL_SUCCESS:return{items:t.users};case u.GETALL_FAILURE:return{error:t.error};case u.DELETE_REQUEST:return Object(d.a)({},e,{items:e.items.map(function(e){return e.id===t.id?Object(d.a)({},e,{deleting:!0}):e})});case u.DELETE_SUCCESS:return{items:e.items.filter(function(e){return e.id!==t.id})};case u.DELETE_FAILURE:return Object(d.a)({},e,{items:e.items.map(function(e){if(e.id===t.id){e.deleting;var a=Object(h.a)(e,["deleting"]);return Object(d.a)({},a,{deleteError:t.error})}return e})});default:return e}},alert:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case A.SUCCESS:return{type:"alert-success",message:t.message};case A.ERROR:return{type:"alert-danger",message:t.message};case A.CLEAR:return{};default:return e}}}),f=Object(l.createLogger)(),p=Object(i.d)(g,Object(i.a)(c.a,f)),S=a(6),C=a(7),R=a(11),b=a(8),O=a(10),v=a(47),U=a(46),I=a(45),w=a(31),L=JSON.parse(localStorage.getItem("users"))||[];var N=a(13),G=Object(N.a)();function T(){var e=JSON.parse(localStorage.getItem("user"));return e&&e.token?{Authorization:"Bearer "+e.token}:{}}var j={success:function(e){return{type:A.SUCCESS,message:e}},error:function(e){return{type:A.ERROR,message:e}},clear:function(){return{type:A.CLEAR}}};var y=a(15),Q={login:function(e,t){var a={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:t})};return fetch("".concat(y.apiUrl,"/users/authenticate"),a).then(_).then(function(e){return localStorage.setItem("user",JSON.stringify(e)),e})},logout:k,register:function(e){var t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)};return fetch("".concat(y.apiUrl,"/users/register"),t).then(_)},getAll:function(){var e={method:"GET",headers:T()};return fetch("".concat(y.apiUrl,"/users"),e).then(_)},getById:function(e){var t={method:"GET",headers:T()};return fetch("".concat(y.apiUrl,"/users/").concat(e),t).then(_)},update:function(e){var t={method:"PUT",headers:Object(d.a)({},T(),{"Content-Type":"application/json"}),body:JSON.stringify(e)};return fetch("".concat(y.apiUrl,"/users/").concat(e.id),t).then(_)},delete:function(e){var t={method:"DELETE",headers:T()};return fetch("".concat(y.apiUrl,"/users/").concat(e),t).then(_)}};function k(){localStorage.removeItem("user")}function _(e){return e.text().then(function(t){var a=t&&JSON.parse(t);if(!e.ok){401===e.status&&(k(),document.location.reload(!0));var r=a&&a.message||e.statusText;return Promise.reject(r)}return a})}var D={login:function(e,t){return function(a){var r;a((r={username:e},{type:u.LOGIN_REQUEST,user:r})),Q.login(e,t).then(function(e){a(function(e){return{type:u.LOGIN_SUCCESS,user:e}}(e)),G.push("/")},function(e){a(function(e){return{type:u.LOGIN_FAILURE,error:e}}(e.toString())),a(j.error(e.toString()))})}},logout:function(){return Q.logout(),{type:u.LOGOUT}},register:function(e){return function(t){t(function(e){return{type:u.REGISTER_REQUEST,user:e}}(e)),Q.register(e).then(function(e){t(function(e){return{type:u.REGISTER_SUCCESS,user:e}}()),G.push("/login"),t(j.success("Registration successful"))},function(e){t(function(e){return{type:u.REGISTER_FAILURE,error:e}}(e.toString())),t(j.error(e.toString()))})}},getAll:function(){return function(e){e({type:u.GETALL_REQUEST}),Q.getAll().then(function(t){return e(function(e){return{type:u.GETALL_SUCCESS,users:e}}(t))},function(t){return e(function(e){return{type:u.GETALL_FAILURE,error:e}}(t.toString()))})}},delete:function(e){return function(t){t(function(e){return{type:u.DELETE_REQUEST,id:e}}(e)),Q.delete(e).then(function(a){return t(function(e){return{type:u.DELETE_SUCCESS,id:e}}(e))},function(a){return t(function(e,t){return{type:u.DELETE_FAILURE,id:e,error:t}}(e,a.toString()))})}}};var J=a(44),M=function(e){var t=e.component,a=Object(h.a)(e,["component"]);return n.a.createElement(I.a,Object.assign({},a,{render:function(e){return localStorage.getItem("user")?n.a.createElement(t,e):n.a.createElement(J.a,{to:{pathname:"/login",state:{from:e.location}}})}}))},B=a(43),F=function(e){function t(){return Object(S.a)(this,t),Object(R.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(O.a)(t,e),Object(C.a)(t,[{key:"componentDidMount",value:function(){this.props.dispatch(D.getAll())}},{key:"handleDeleteUser",value:function(e){var t=this;return function(a){return t.props.dispatch(D.delete(e))}}},{key:"render",value:function(){var e=this,t=this.props,a=t.user,r=t.users;return n.a.createElement("div",{className:"col-md-6 col-md-offset-3"},n.a.createElement("h1",null,"Hi ",a.firstName,"!"),n.a.createElement("p",null,"You're logged in with React!!"),n.a.createElement("h3",null,"All registered users:"),r.loading&&n.a.createElement("em",null,"Loading users..."),r.error&&n.a.createElement("span",{className:"text-danger"},"ERROR: ",r.error),r.items&&n.a.createElement("ul",null,r.items.map(function(t,a){return n.a.createElement("li",{key:t.id},t.firstName+" "+t.lastName,t.deleting?n.a.createElement("em",null," - Deleting..."):t.deleteError?n.a.createElement("span",{className:"text-danger"}," - ERROR: ",t.deleteError):n.a.createElement("span",null," - ",n.a.createElement("button",{onClick:e.handleDeleteUser(t.id)},"Delete")))})),n.a.createElement("p",null,n.a.createElement(B.a,{to:"/login"},"Logout")))}}]),t}(n.a.Component);var K=Object(o.b)(function(e){var t=e.users;return{user:e.authentication.user,users:t}})(F),Y=a(16),x=a(5),H=function(e){function t(e){var a;return Object(S.a)(this,t),(a=Object(R.a)(this,Object(b.a)(t).call(this,e))).props.dispatch(D.logout()),a.state={username:"",password:"",submitted:!1},a.handleChange=a.handleChange.bind(Object(x.a)(Object(x.a)(a))),a.handleSubmit=a.handleSubmit.bind(Object(x.a)(Object(x.a)(a))),a}return Object(O.a)(t,e),Object(C.a)(t,[{key:"handleChange",value:function(e){var t=e.target,a=t.name,r=t.value;this.setState(Object(Y.a)({},a,r))}},{key:"handleSubmit",value:function(e){e.preventDefault(),this.setState({submitted:!0});var t=this.state,a=t.username,r=t.password,n=this.props.dispatch;a&&r&&n(D.login(a,r))}},{key:"render",value:function(){var e=this.props.loggingIn,t=this.state,a=t.username,r=t.password,s=t.submitted;return n.a.createElement("div",{className:"col-md-6 col-md-offset-3"},n.a.createElement("h2",null,"Login"),n.a.createElement("form",{name:"form",onSubmit:this.handleSubmit},n.a.createElement("div",{className:"form-group"+(s&&!a?" has-error":"")},n.a.createElement("label",{htmlFor:"username"},"Username"),n.a.createElement("input",{type:"text",className:"form-control",name:"username",value:a,onChange:this.handleChange}),s&&!a&&n.a.createElement("div",{className:"help-block"},"Username is required")),n.a.createElement("div",{className:"form-group"+(s&&!r?" has-error":"")},n.a.createElement("label",{htmlFor:"password"},"Password"),n.a.createElement("input",{type:"password",className:"form-control",name:"password",value:r,onChange:this.handleChange}),s&&!r&&n.a.createElement("div",{className:"help-block"},"Password is required")),n.a.createElement("div",{className:"form-group"},n.a.createElement("button",{className:"btn btn-primary"},"Login"),e&&n.a.createElement("img",{alt:"load",src:"data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA=="}),n.a.createElement(B.a,{to:"/register",className:"btn btn-link"},"Register"))))}}]),t}(n.a.Component);var P=Object(o.b)(function(e){return{loggingIn:e.authentication.loggingIn}})(H),W=function(e){function t(e){var a;return Object(S.a)(this,t),(a=Object(R.a)(this,Object(b.a)(t).call(this,e))).state={user:{firstName:"",lastName:"",username:"",password:""},submitted:!1},a.handleChange=a.handleChange.bind(Object(x.a)(Object(x.a)(a))),a.handleSubmit=a.handleSubmit.bind(Object(x.a)(Object(x.a)(a))),a}return Object(O.a)(t,e),Object(C.a)(t,[{key:"handleChange",value:function(e){var t=e.target,a=t.name,r=t.value,n=this.state.user;this.setState({user:Object(d.a)({},n,Object(Y.a)({},a,r))})}},{key:"handleSubmit",value:function(e){e.preventDefault(),this.setState({submitted:!0});var t=this.state.user,a=this.props.dispatch;t.firstName&&t.lastName&&t.username&&t.password&&a(D.register(t))}},{key:"render",value:function(){var e=this.props.registering,t=this.state,a=t.user,r=t.submitted;return n.a.createElement("div",{className:"col-md-6 col-md-offset-3"},n.a.createElement("h2",null,"Register"),n.a.createElement("form",{name:"form",onSubmit:this.handleSubmit},n.a.createElement("div",{className:"form-group"+(r&&!a.firstName?" has-error":"")},n.a.createElement("label",{htmlFor:"firstName"},"First Name"),n.a.createElement("input",{type:"text",className:"form-control",name:"firstName",value:a.firstName,onChange:this.handleChange}),r&&!a.firstName&&n.a.createElement("div",{className:"help-block"},"First Name is required")),n.a.createElement("div",{className:"form-group"+(r&&!a.lastName?" has-error":"")},n.a.createElement("label",{htmlFor:"lastName"},"Last Name"),n.a.createElement("input",{type:"text",className:"form-control",name:"lastName",value:a.lastName,onChange:this.handleChange}),r&&!a.lastName&&n.a.createElement("div",{className:"help-block"},"Last Name is required")),n.a.createElement("div",{className:"form-group"+(r&&!a.username?" has-error":"")},n.a.createElement("label",{htmlFor:"username"},"Username"),n.a.createElement("input",{type:"text",className:"form-control",name:"username",value:a.username,onChange:this.handleChange}),r&&!a.username&&n.a.createElement("div",{className:"help-block"},"Username is required")),n.a.createElement("div",{className:"form-group"+(r&&!a.password?" has-error":"")},n.a.createElement("label",{htmlFor:"password"},"Password"),n.a.createElement("input",{type:"password",className:"form-control",name:"password",value:a.password,onChange:this.handleChange}),r&&!a.password&&n.a.createElement("div",{className:"help-block"},"Password is required")),n.a.createElement("div",{className:"form-group"},n.a.createElement("button",{className:"btn btn-primary"},"Register"),e&&n.a.createElement("img",{alt:"loading",src:"data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA=="}),n.a.createElement(B.a,{to:"/login",className:"btn btn-link"},"Cancel"))))}}]),t}(n.a.Component);var z=Object(o.b)(function(e){return{registering:e.registration.registering}})(W),V=function(e){function t(){return Object(S.a)(this,t),Object(R.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(O.a)(t,e),Object(C.a)(t,[{key:"render",value:function(){return n.a.createElement("div",{className:"col-md-6 col-md-offset-3"},n.a.createElement("h1",null,"Page Not Found"),n.a.createElement(B.a,{to:"/"},"Go to Homepage"))}}]),t}(n.a.Component),Z=function(e){function t(e){var a;Object(S.a)(this,t);var r=(a=Object(R.a)(this,Object(b.a)(t).call(this,e))).props.dispatch;return G.listen(function(e,t){r(j.clear())}),a}return Object(O.a)(t,e),Object(C.a)(t,[{key:"render",value:function(){var e=this.props.alert;return n.a.createElement("div",{className:"jumbotron"},n.a.createElement("div",{className:"container"},n.a.createElement("div",{className:"col-sm-8 col-sm-offset-2"},e.message&&n.a.createElement("div",{className:"alert ".concat(e.type)},e.message),n.a.createElement(v.a,{history:G},n.a.createElement(U.a,null,n.a.createElement(M,{exact:!0,path:"/",component:K}),n.a.createElement(I.a,{path:"/login",component:P}),n.a.createElement(I.a,{path:"/register",component:z}),n.a.createElement(I.a,{path:"*",component:V}))))))}}]),t}(n.a.Component);var q=Object(o.b)(function(e){return{alert:e.alert}})(Z);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));!function(){var e=window.fetch;window.fetch=function(t,a){return new Promise(function(r,n){setTimeout(function(){if(t.endsWith("/users/authenticate")&&"POST"===a.method){var s=JSON.parse(a.body),o=L.filter(function(e){return e.username===s.username&&e.password===s.password});if(o.length){var i=o[0],c={id:i.id,username:i.username,firstName:i.firstName,lastName:i.lastName,token:"fake-jwt-token"};r({ok:!0,text:function(){return Promise.resolve(JSON.stringify(c))}})}else n("Username or password is incorrect")}else if(t.endsWith("/users")&&"GET"===a.method)a.headers&&"Bearer fake-jwt-token"===a.headers.Authorization?r({ok:!0,text:function(){return Promise.resolve(JSON.stringify(L))}}):n("Unauthorised");else if(t.match(/\/users\/\d+$/)&&"GET"===a.method)if(a.headers&&"Bearer fake-jwt-token"===a.headers.Authorization){var l=t.split("/"),A=parseInt(l[l.length-1]),u=L.filter(function(e){return e.id===A}),m=u.length?u[0]:null;r({ok:!0,text:function(){return JSON.stringify(m)}})}else n("Unauthorised");else{if(t.endsWith("/users/register")&&"POST"===a.method){var E=JSON.parse(a.body);return L.filter(function(e){return e.username===E.username}).length?void n('Username "'+E.username+'" is already taken'):(E.id=L.length?Math.max.apply(Math,Object(w.a)(L.map(function(e){return e.id})))+1:1,L.push(E),localStorage.setItem("users",JSON.stringify(L)),void r({ok:!0,text:function(){return Promise.resolve()}}))}if(t.match(/\/users\/\d+$/)&&"DELETE"===a.method)if(a.headers&&"Bearer fake-jwt-token"===a.headers.Authorization){for(var h=t.split("/"),d=parseInt(h[h.length-1]),g=0;g<L.length;g++)if(L[g].id===d){L.splice(g,1),localStorage.setItem("users",JSON.stringify(L));break}r({ok:!0,text:function(){return Promise.resolve()}})}else n("Unauthorised");else e(t,a).then(function(e){return r(e)})}},500)})}}(),Object(s.render)(n.a.createElement(o.a,{store:p},n.a.createElement(q,null)),document.getElementById("app")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[32,2,1]]]);
//# sourceMappingURL=main.b6859762.chunk.js.map